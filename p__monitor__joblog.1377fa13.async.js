(self.webpackChunkruoyi_react=self.webpackChunkruoyi_react||[]).push([[4070],{82920:function(ye,U,n){"use strict";n.r(U),n.d(U,{default:function(){return je}});var X=n(11849),Ce=n(71194),O=n(50146),Je=n(57663),C=n(71577),Ie=n(54029),q=n(79166),E=n(2824),Me=n(34792),v=n(48086),f=n(3182),_=n(94043),s=n.n(_),ee=n(57119),te=n(72850),ae=n(48176),j=n(67294),i=n(43581),ne=n(43686),re=n(66548),oe=n(24480),$=n(11238);function se(l,t){return B.apply(this,arguments)}function B(){return B=(0,f.Z)(s().mark(function l(t,u){return s().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,$.ZP)("/api/monitor/jobLog/list",{params:(0,oe.f)(t,u),method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return r.stop()}},l)})),B.apply(this,arguments)}function Oe(l){return request("/api/monitor/jobLog/".concat(l),{method:"GET"})}function Re(l){return H.apply(this,arguments)}function H(){return H=_asyncToGenerator(_regeneratorRuntime.mark(function l(t){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/monitor/jobLog",{method:"POST",data:t}));case 1:case"end":return a.stop()}},l)})),H.apply(this,arguments)}function we(l){return k.apply(this,arguments)}function k(){return k=_asyncToGenerator(_regeneratorRuntime.mark(function l(t){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/monitor/jobLog",{method:"PUT",data:t}));case 1:case"end":return a.stop()}},l)})),k.apply(this,arguments)}function V(l){return A.apply(this,arguments)}function A(){return A=(0,f.Z)(s().mark(function l(t){return s().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,$.ZP)("/api/monitor/jobLog/".concat(t),{method:"DELETE",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return a.stop()}},l)})),A.apply(this,arguments)}function ie(l){return(0,re.su)("/api/monitor/jobLog/export",{params:l},"job_log_".concat(new Date().getTime(),".xlsx"))}function le(){return(0,$.ZP)("/api/monitor/jobLog/clean",{method:"DELETE"})}var Se=n(98858),x=n(4914),$e=n(9715),ue=n(86835),e=n(85893),ce=function(t){var u=ue.Z.useForm(),a=(0,E.Z)(u,1),r=a[0],o=t.values,d=t.statusOptions,p=t.jobGroupOptions;(0,j.useEffect)(function(){r.resetFields(),r.setFieldsValue({jobLogId:t.values.jobLogId,jobName:t.values.jobName,jobGroup:t.values.jobGroup,invokeTarget:t.values.invokeTarget,jobMessage:t.values.jobMessage,status:t.values.status,exceptionInfo:t.values.exceptionInfo,createTime:t.values.createTime})},[r,t]);var R=(0,i.YB)(),D=function(){r.submit()},w=function(){t.onCancel(),r.resetFields()};return(0,e.jsx)(O.Z,{"data-inspector-line":"45","data-inspector-column":"4","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",width:640,title:R.formatMessage({id:"monitor.JobLog.title",defaultMessage:"\u5B9A\u65F6\u4EFB\u52A1\u8C03\u5EA6\u65E5\u5FD7"}),visible:t.visible,destroyOnClose:!0,onOk:D,onCancel:w,children:(0,e.jsxs)(x.Z,{"data-inspector-line":"56","data-inspector-column":"6","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",column:24,children:[(0,e.jsx)(x.Z.Item,{"data-inspector-line":"57","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",span:12,label:(0,e.jsx)(i._H,{"data-inspector-line":"59","data-inspector-column":"17","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",id:"monitor.Job.job_id",defaultMessage:"\u4EFB\u52A1\u7F16\u53F7"}),children:o.jobLogId}),(0,e.jsx)(x.Z.Item,{"data-inspector-line":"63","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",span:12,label:(0,e.jsx)(i._H,{"data-inspector-line":"65","data-inspector-column":"17","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",id:"monitor.Job.create_time",defaultMessage:"\u6267\u884C\u65F6\u95F4"}),children:o.createTime}),(0,e.jsx)(x.Z.Item,{"data-inspector-line":"69","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",span:12,label:(0,e.jsx)(i._H,{"data-inspector-line":"71","data-inspector-column":"17","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",id:"monitor.Job.job_name",defaultMessage:"\u4EFB\u52A1\u540D\u79F0"}),children:o.jobName}),(0,e.jsx)(x.Z.Item,{"data-inspector-line":"75","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",span:12,label:(0,e.jsx)(i._H,{"data-inspector-line":"77","data-inspector-column":"17","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",id:"monitor.Job.job_group",defaultMessage:"\u4EFB\u52A1\u7EC4\u540D"}),children:p[o.jobGroup?o.jobGroup:"DEFAULT"]}),(0,e.jsx)(x.Z.Item,{"data-inspector-line":"81","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",span:24,label:(0,e.jsx)(i._H,{"data-inspector-line":"83","data-inspector-column":"17","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",id:"monitor.Job.invoke_target",defaultMessage:"\u8C03\u7528\u76EE\u6807"}),children:o.invokeTarget}),(0,e.jsx)(x.Z.Item,{"data-inspector-line":"87","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",span:24,label:(0,e.jsx)(i._H,{"data-inspector-line":"89","data-inspector-column":"17","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",id:"monitor.Job.job_message",defaultMessage:"\u65E5\u5FD7\u4FE1\u606F"}),children:o.jobMessage}),(0,e.jsx)(x.Z.Item,{"data-inspector-line":"93","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",span:24,label:(0,e.jsx)(i._H,{"data-inspector-line":"95","data-inspector-column":"17","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",id:"monitor.Job.exception_info",defaultMessage:"\u5F02\u5E38\u4FE1\u606F"}),children:o.exceptionInfo}),(0,e.jsx)(x.Z.Item,{"data-inspector-line":"99","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",span:12,label:(0,e.jsx)(i._H,{"data-inspector-line":"101","data-inspector-column":"17","data-inspector-relative-path":"src/pages/monitor/joblog/components/detail.tsx",id:"monitor.Job.status",defaultMessage:"\u6267\u884C\u72B6\u6001"}),children:d[o.status?o.status:0]})]})})},de=ce,z=n(52346),pe=n(78009),me=n(85224),ge=function(){var l=(0,f.Z)(s().mark(function t(u){var a,r;return s().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=v.default.loading("\u6B63\u5728\u5220\u9664"),u){d.next=3;break}return d.abrupt("return",!0);case 3:return d.prev=3,d.next=6,V(u.map(function(p){return p.jobLogId}).join(","));case 6:return r=d.sent,a(),r.code===200?v.default.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):v.default.error(r.msg),d.abrupt("return",!0);case 12:return d.prev=12,d.t0=d.catch(3),a(),v.default.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),d.abrupt("return",!1);case 17:case"end":return d.stop()}},t,null,[[3,12]])}));return function(u){return l.apply(this,arguments)}}(),ve=function(){var l=(0,f.Z)(s().mark(function t(){var u,a;return s().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return u=v.default.loading("\u6B63\u5728\u5220\u9664"),o.prev=1,o.next=4,le();case 4:return a=o.sent,u(),a.code===200?v.default.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):v.default.error(a.msg),o.abrupt("return",!0);case 10:return o.prev=10,o.t0=o.catch(1),u(),v.default.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),o.abrupt("return",!1);case 15:case"end":return o.stop()}},t,null,[[1,10]])}));return function(){return l.apply(this,arguments)}}(),he=function(){var l=(0,f.Z)(s().mark(function t(u){var a,r,o;return s().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(a=v.default.loading("\u6B63\u5728\u5220\u9664"),u){p.next=3;break}return p.abrupt("return",!0);case 3:return p.prev=3,r=[u.jobLogId],p.next=7,V(r.join(","));case 7:return o=p.sent,a(),o.code===200?v.default.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):v.default.error(o.msg),p.abrupt("return",!0);case 13:return p.prev=13,p.t0=p.catch(3),a(),v.default.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),p.abrupt("return",!1);case 18:case"end":return p.stop()}},t,null,[[3,13]])}));return function(u){return l.apply(this,arguments)}}(),fe=function(){var l=(0,f.Z)(s().mark(function t(){var u;return s().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return u=v.default.loading("\u6B63\u5728\u5BFC\u51FA"),r.prev=1,r.next=4,ie();case 4:return u(),v.default.success("\u5BFC\u51FA\u6210\u529F"),r.abrupt("return",!0);case 9:return r.prev=9,r.t0=r.catch(1),u(),v.default.error("\u5BFC\u51FA\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),r.abrupt("return",!1);case 14:case"end":return r.stop()}},t,null,[[1,9]])}));return function(){return l.apply(this,arguments)}}(),be=function(){var t=(0,j.useRef)(),u=(0,j.useState)(!1),a=(0,E.Z)(u,2),r=a[0],o=a[1],d=(0,j.useRef)(),p=(0,j.useState)(),R=(0,E.Z)(p,2),D=R[0],w=R[1],G=(0,j.useState)([]),N=(0,E.Z)(G,2),J=N[0],W=N[1],xe=(0,j.useState)([]),Y=(0,E.Z)(xe,2),P=Y[0],Te=Y[1],Ze=(0,j.useState)([]),K=(0,E.Z)(Ze,2),Q=K[0],Fe=K[1],I=(0,i.md)(),Ee=(0,i.YB)();(0,j.useEffect)(function(){(0,z.zP)("sys_job_status").then(function(g){if(g.code===200){var m={};g.data.forEach(function(c){m[c.dictValue]=c.dictLabel}),Te(m)}}),(0,z.zP)("sys_job_group").then(function(g){if(g.code===200){var m={};g.data.forEach(function(c){m[c.dictValue]=c.dictLabel}),Fe(m)}})},[]);var Le=[{title:(0,e.jsx)(i._H,{"data-inspector-line":"142","data-inspector-column":"13","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"monitor.JobLog.job_log_id",defaultMessage:"\u4EFB\u52A1\u65E5\u5FD7ID"}),dataIndex:"jobLogId",valueType:"text",hideInSearch:!0},{title:(0,e.jsx)(i._H,{"data-inspector-line":"148","data-inspector-column":"13","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"monitor.JobLog.job_name",defaultMessage:"\u4EFB\u52A1\u540D\u79F0"}),dataIndex:"jobName",valueType:"text"},{title:(0,e.jsx)(i._H,{"data-inspector-line":"153","data-inspector-column":"13","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"monitor.JobLog.job_group",defaultMessage:"\u4EFB\u52A1\u7EC4\u540D"}),dataIndex:"jobGroup",valueType:"text",valueEnum:Q},{title:(0,e.jsx)(i._H,{"data-inspector-line":"159","data-inspector-column":"13","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"monitor.JobLog.invoke_target",defaultMessage:"\u8C03\u7528\u76EE\u6807\u5B57\u7B26\u4E32"}),dataIndex:"invokeTarget",valueType:"textarea",hideInSearch:!0,ellipsis:!0},{title:(0,e.jsx)(i._H,{"data-inspector-line":"166","data-inspector-column":"13","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"monitor.JobLog.job_message",defaultMessage:"\u65E5\u5FD7\u4FE1\u606F"}),dataIndex:"jobMessage",valueType:"textarea",hideInSearch:!0},{title:(0,e.jsx)(i._H,{"data-inspector-line":"172","data-inspector-column":"13","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"monitor.JobLog.status",defaultMessage:"\u6267\u884C\u72B6\u6001"}),dataIndex:"status",valueType:"select",valueEnum:P,render:function(m,c){return(0,e.jsx)(q.Z,{"data-inspector-line":"177","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",status:c.status==="0"?"success":"error",text:P[c.status]})}},{title:(0,e.jsx)(i._H,{"data-inspector-line":"184","data-inspector-column":"13","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"system.User.createTime",defaultMessage:"\u6267\u884C\u65F6\u95F4"}),dataIndex:"createTime",valueType:"dateRange",sorter:!0,defaultSortOrder:"descend",render:function(m,c){return(0,e.jsx)("span",{"data-inspector-line":"189","data-inspector-column":"29","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",children:c.createTime})},search:{transform:function(m){return{"params[beginTime]":m[0],"params[endTime]":m[1]}}}},{title:(0,e.jsx)(i._H,{"data-inspector-line":"200","data-inspector-column":"13","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",width:"220px",valueType:"option",render:function(m,c){return[(0,e.jsx)(C.Z,{"data-inspector-line":"205","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",type:"link",size:"small",hidden:!I.hasPerms("monitor:log:list"),onClick:function(){o(!0),w(c)},children:"\u8BE6\u7EC6"},"detail"),(0,e.jsx)(C.Z,{"data-inspector-line":"217","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",type:"link",size:"small",danger:!0,hidden:!I.hasPerms("monitor:log:remove"),onClick:(0,f.Z)(s().mark(function h(){return s().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:O.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u9879\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var T=(0,f.Z)(s().mark(function L(){var F;return s().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,he(c);case 2:F=M.sent,F&&d.current&&d.current.reload();case 4:case"end":return M.stop()}},L)}));function b(){return T.apply(this,arguments)}return b}()});case 1:case"end":return Z.stop()}},h)})),children:"\u5220\u9664"},"batchRemove")]}}];return(0,e.jsxs)(pe.ZP,{"data-inspector-line":"247","data-inspector-column":"4","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",breadcrumb:void 0,onBack:function(){return i.m8.goBack()},title:"\u5B9A\u65F6\u4EFB\u52A1",subTitle:"\u8C03\u5EA6\u65E5\u5FD7",children:[(0,e.jsx)(ne.ZP,{"data-inspector-line":"253","data-inspector-column":"6","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",headerTitle:Ee.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u4FE1\u606F"}),actionRef:d,formRef:t,rowKey:"jobLogId",search:{labelWidth:"auto"},toolBarRender:function(){return[(0,e.jsxs)(C.Z,{"data-inspector-line":"266","data-inspector-column":"10","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",type:"text",danger:!0,hidden:!I.hasPerms("monitor:operlog:remove"),onClick:(0,f.Z)(s().mark(function m(){return s().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:O.Z.confirm({title:"\u662F\u5426\u786E\u8BA4\u6E05\u7A7A\u6240\u6709\u767B\u5F55\u65E5\u5FD7\u6570\u636E\u9879?",icon:(0,e.jsx)(ee.Z,{"data-inspector-line":"274","data-inspector-column":"22","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx"}),content:"\u8BF7\u8C28\u614E\u64CD\u4F5C",onOk:function(){return(0,f.Z)(s().mark(function Z(){var T,b;return s().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:ve(),(T=d.current)===null||T===void 0||(b=T.reloadAndRest)===null||b===void 0||b.call(T);case 2:case"end":return F.stop()}},Z)}))()},onCancel:function(){}});case 1:case"end":return h.stop()}},m)})),children:[(0,e.jsx)(te.Z,{"data-inspector-line":"284","data-inspector-column":"12","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx"})," ",(0,e.jsx)(i._H,{"data-inspector-line":"285","data-inspector-column":"12","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"pages.searchTable.clear",defaultMessage:"\u6E05\u7A7A"})]},"clear"),(0,e.jsxs)(C.Z,{"data-inspector-line":"287","data-inspector-column":"10","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",type:"text",hidden:!I.hasPerms("monitor:log:export"),onClick:(0,f.Z)(s().mark(function m(){return s().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:fe();case 1:case"end":return h.stop()}},m)})),children:[(0,e.jsx)(ae.Z,{"data-inspector-line":"295","data-inspector-column":"12","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx"})," ",(0,e.jsx)(i._H,{"data-inspector-line":"296","data-inspector-column":"12","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"pages.searchTable.export",defaultMessage:"\u5BFC\u51FA"})]},"export")]},request:function(m){return se((0,X.Z)({},m)).then(function(c){var h={data:c.rows,total:c.total,success:!0};return h})},columns:Le,rowSelection:{onChange:function(m,c){W(c)}}},"jobLogList"),(J==null?void 0:J.length)>0&&(0,e.jsx)(me.Z,{"data-inspector-line":"317","data-inspector-column":"8","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",extra:(0,e.jsxs)("div",{"data-inspector-line":"319","data-inspector-column":"12","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",children:[(0,e.jsx)(i._H,{"data-inspector-line":"320","data-inspector-column":"14","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"pages.searchTable.chosen",defaultMessage:"\u5DF2\u9009\u62E9"}),(0,e.jsx)("a",{"data-inspector-line":"321","data-inspector-column":"14","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",style:{fontWeight:600},children:J.length}),(0,e.jsx)(i._H,{"data-inspector-line":"322","data-inspector-column":"14","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"pages.searchTable.item",defaultMessage:"\u9879"})]}),children:(0,e.jsx)(C.Z,{"data-inspector-line":"326","data-inspector-column":"10","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",danger:!0,hidden:!I.hasPerms("monitor:log:remove"),onClick:(0,f.Z)(s().mark(function g(){return s().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:O.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u9879\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var h=(0,f.Z)(s().mark(function Z(){var T,b,L;return s().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,ge(J);case 2:T=y.sent,T&&(W([]),(b=d.current)===null||b===void 0||(L=b.reloadAndRest)===null||L===void 0||L.call(b));case 4:case"end":return y.stop()}},Z)}));function S(){return h.apply(this,arguments)}return S}()});case 1:case"end":return c.stop()}},g)})),children:(0,e.jsx)(i._H,{"data-inspector-line":"346","data-inspector-column":"12","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",id:"pages.searchTable.batchDeletion",defaultMessage:"\u6279\u91CF\u5220\u9664"})},"batchRemove")}),(0,e.jsx)(de,{"data-inspector-line":"350","data-inspector-column":"6","data-inspector-relative-path":"src/pages/monitor/joblog/index.tsx",onCancel:function(){o(!1),w(void 0)},visible:r,values:D||{},statusOptions:P,jobGroupOptions:Q})]})},je=be}}]);
