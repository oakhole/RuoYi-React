(self.webpackChunkruoyi_react=self.webpackChunkruoyi_react||[]).push([[7350],{47407:function(A){A.exports={miniChart:"miniChart___132EF",chartContent:"chartContent___2bnF8",chartLoading:"chartLoading___1MB4M"}},12323:function(A){A.exports={card:"card___Am-TQ",miniChart:"miniChart___QiAb_",chartContent:"chartContent___2BQwg",chartLoading:"chartLoading___2bDkP"}},48655:function(A,O,n){"use strict";n.r(O),n.d(O,{default:function(){return Tt}});var bt=n(13062),K=n(71230),wt=n(89032),B=n(15746),qt=n(58024),G=n(39144),_t=n(66456),it=n(61128),N=n(2824),C=n(67294),st=n(3182),lt=n(94043),V=n.n(lt),ct=n(11238);function dt(){return T.apply(this,arguments)}function T(){return T=(0,st.Z)(V().mark(function c(){return V().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,ct.ZP)("/api/monitor/cache",{method:"GET"}));case 1:case"end":return s.stop()}},c)})),T.apply(this,arguments)}var ut=n(12323),R=n.n(ut),ht=n(21349),p=n(89415),$=n(11849),W=n(69610),M=n(54941),E=n(81306),P=n(59206),e=n(85893);function J(c){var r=c.style;r.height="100%";var s=parseInt("".concat(getComputedStyle(c).height),10),t=parseInt("".concat(getComputedStyle(c).paddingTop),10)+parseInt("".concat(getComputedStyle(c).paddingBottom),10);return s-t}function X(c){if(!c)return 0;var r=c,s=J(r),t=r.parentNode;return t&&(s=J(t)),s}function ft(){return function(c){var r=function(s){(0,E.Z)(i,s);var t=(0,P.Z)(i);function i(){var d;(0,W.Z)(this,i);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return d=t.call.apply(t,[this].concat(o)),d.state={computedHeight:0},d.root=null,d.handleRoot=function(h){d.root=h},d}return(0,M.Z)(i,[{key:"componentDidMount",value:function(){var a=this.props.height;if(!a&&this.root){var o=X(this.root);this.setState({computedHeight:o}),o<1&&(o=X(this.root),this.setState({computedHeight:o}))}}},{key:"render",value:function(){var a=this.props.height,o=this.state.computedHeight,l=a||o;return(0,e.jsx)("div",{ref:this.handleRoot,children:l>0&&(0,e.jsx)(c,(0,$.Z)((0,$.Z)({},this.props),{},{height:l}))})}}]),i}(C.Component);return r}}var pt=ft,Y=p.Guide.Arc,vt=p.Guide.Html,k=p.Guide.Line,mt=function(r){switch(r){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};p.Shape.registerShape&&p.Shape.registerShape("point","pointer",{drawShape:function(r,s){var t=r.points[0];t=this.parsePoint(t);var i=this.parsePoint({x:0,y:0});return s.addShape("line",{attrs:{x1:i.x,y1:i.y,x2:t.x,y2:t.y,stroke:r.color,lineWidth:2,lineCap:"round"}}),s.addShape("circle",{attrs:{x:i.x,y:i.y,r:6,stroke:r.color,lineWidth:3,fill:"#fff"}})}});var gt=function(r){var s=r.title,t=r.height,i=t===void 0?1:t,d=r.percent,a=r.forceFit,o=a===void 0?!0:a,l=r.formatter,h=l===void 0?mt:l,v=r.color,f=v===void 0?"#2F9CFF":v,m=r.bgColor,Z=m===void 0?"#F0F2F5":m,S={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},j=[{value:d/10}],F=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(s,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((j[0].value*10).toFixed(2),`%
    </div>
  </div>`)},u={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return(0,e.jsxs)(p.Chart,{height:i,data:j,scale:S,padding:[-16,0,16,0],forceFit:o,children:[(0,e.jsx)(p.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),(0,e.jsx)(p.Axis,{name:"1",line:void 0}),(0,e.jsx)(p.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:h,textStyle:u}}),(0,e.jsxs)(p.Guide,{children:[(0,e.jsx)(k,{start:[3,.905],end:[3,.85],lineStyle:{stroke:f,lineDash:void 0,lineWidth:2}}),(0,e.jsx)(k,{start:[5,.905],end:[5,.85],lineStyle:{stroke:f,lineDash:void 0,lineWidth:3}}),(0,e.jsx)(k,{start:[7,.905],end:[7,.85],lineStyle:{stroke:f,lineDash:void 0,lineWidth:3}}),(0,e.jsx)(Y,{start:[0,.965],end:[10,.965],style:{stroke:Z,lineWidth:10}}),(0,e.jsx)(Y,{start:[0,.965],end:[j[0].value,.965],style:{stroke:f,lineWidth:10}}),(0,e.jsx)(vt,{position:["50%","95%"],html:F()})]}),(0,e.jsx)(p.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:f,active:!1})]})},xt=pt()(gt),te=n(48736),yt=n(27049),b=n(32059),Ct=n(63531),St=n(91296),jt=n.n(St),Ft=n(46618),Zt=n.n(Ft),Dt=n(94184),Ht=n.n(Dt);function w(c){var r=c.style;r.height="100%";var s=parseInt("".concat(getComputedStyle(c).height),10),t=parseInt("".concat(getComputedStyle(c).paddingTop),10)+parseInt("".concat(getComputedStyle(c).paddingBottom),10);return s-t}function q(c){if(!c)return 0;var r=c,s=w(r),t=r.parentNode;return t&&(s=w(t)),s}function It(){return function(c){var r=function(s){(0,E.Z)(i,s);var t=(0,P.Z)(i);function i(){var d;(0,W.Z)(this,i);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return d=t.call.apply(t,[this].concat(o)),d.state={computedHeight:0},d.root=void 0,d.handleRoot=function(h){d.root=h},d}return(0,M.Z)(i,[{key:"componentDidMount",value:function(){var a=this.props.height;if(!a){var o=q(this.root);this.setState({computedHeight:o}),o<1&&(o=q(this.root),this.setState({computedHeight:o}))}}},{key:"render",value:function(){var a=this.props.height,o=this.state.computedHeight,l=a||o;return(0,e.jsx)("div",{ref:this.handleRoot,children:l>0&&(0,e.jsx)(c,(0,$.Z)((0,$.Z)({},this.props),{},{height:l}))})}}]),i}(C.Component);return r}}var At=It,Nt=n(47407),y=n.n(Nt),$t=function(c){(0,E.Z)(s,c);var r=(0,P.Z)(s);function s(){var t;(0,W.Z)(this,s);for(var i=arguments.length,d=new Array(i),a=0;a<i;a++)d[a]=arguments[a];return t=r.call.apply(r,[this].concat(d)),t.state={legendData:[],legendBlock:!1},t.requestRef=void 0,t.root=void 0,t.chart=void 0,t.resize=jt()(function(){var o=t.props.hasLegend,l=t.state.legendBlock;if(!o||!t.root){window.removeEventListener("resize",t.resize);return}t.root&&t.root.parentNode&&t.root.parentNode.clientWidth<=380?l||t.setState({legendBlock:!0}):l&&t.setState({legendBlock:!1})},400),t.getG2Instance=function(o){t.chart=o,requestAnimationFrame(function(){t.getLegendData(),t.resize()})},t.getLegendData=function(){if(!!t.chart){var o=t.chart.getAllGeoms()[0];if(!!o){var l=o.get("dataArray")||[],h=l.map(function(v){var f=v[0]._origin;return f.color=v[0].color,f.checked=!0,f});t.setState({legendData:h})}}},t.handleRoot=function(o){t.root=o},t.handleLegendClick=function(o,l){var h=o;h.checked=!h.checked;var v=t.state.legendData;v[l]=h;var f=v.filter(function(m){return m.checked}).map(function(m){return m.x});t.chart&&t.chart.filter("x",function(m){return f.indexOf("".concat(m))>-1}),t.setState({legendData:v})},t}return(0,M.Z)(s,[{key:"componentDidMount",value:function(){var i=this;window.addEventListener("resize",function(){i.requestRef=requestAnimationFrame(function(){return i.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(i){var d=this.props.data;d!==i.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var i,d=this,a=this.props,o=a.valueFormat,l=a.subTitle,h=a.total,v=a.hasLegend,f=v===void 0?!1:v,m=a.className,Z=a.style,S=a.height,j=S===void 0?0:S,F=a.forceFit,u=F===void 0?!0:F,g=a.percent,U=a.color,D=a.inner,Rt=D===void 0?.75:D,_=a.animate,Wt=_===void 0?!0:_,Mt=a.colors,tt=a.lineWidth,Et=tt===void 0?1:tt,et=this.state,Pt=et.legendData,kt=et.legendBlock,Ut=Ht()(y().pie,m,(i={},(0,b.Z)(i,y().hasLegend,!!f),(0,b.Z)(i,y().legendBlock,kt),i)),Q=this.props,Qt=Q.data,at=Q.selected,Ot=at===void 0?!0:at,nt=Q.tooltip,Kt=nt===void 0?!0:nt,L=Qt||[],z=Ot,H=Kt,Vt=Mt;L=L||[],z=z||!0,H=H||!0;var ot,Jt={x:{type:"cat",range:[0,1]},y:{min:0}};(g||g===0)&&(z=!1,H=!1,ot=function(I){return I==="\u5360\u6BD4"?U||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},L=[{x:"\u5360\u6BD4",y:parseFloat("".concat(g))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat(g))}]);var Xt=["x*percent",function(x,I){return{name:x,value:"".concat((I*100).toFixed(2),"%")}}],Yt=[12,0,12,0],rt=new Ct.DataView;return rt.source(L).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),(0,e.jsxs)("div",{ref:this.handleRoot,className:Ut,style:Z,children:[(0,e.jsx)(Zt(),{maxFontSize:25,children:(0,e.jsxs)("div",{className:y().chart,children:[(0,e.jsxs)(p.Chart,{scale:Jt,height:j,forceFit:u,data:rt,padding:Yt,animate:Wt,onGetG2Instance:this.getG2Instance,children:[!!H&&(0,e.jsx)(p.Tooltip,{showTitle:!1}),(0,e.jsx)(p.Coord,{type:"theta",innerRadius:Rt}),(0,e.jsx)(p.Geom,{style:{lineWidth:Et,stroke:"#fff"},tooltip:H?Xt:void 0,type:"intervalStack",position:"percent",color:["x",g||g===0?ot:Vt],selected:z})]}),(l||h)&&(0,e.jsxs)("div",{className:y().total,children:[l&&(0,e.jsx)("h4",{className:"pie-sub-title",children:l}),h&&(0,e.jsx)("div",{className:"pie-stat",children:typeof h=="function"?h():h})]})]})}),f&&(0,e.jsx)("ul",{className:y().legend,children:Pt.map(function(x,I){return(0,e.jsxs)("li",{onClick:function(){return d.handleLegendClick(x,I)},children:[(0,e.jsx)("span",{className:y().dot,style:{backgroundColor:x.checked?x.color:"#aaa"}}),(0,e.jsx)("span",{className:y().legendTitle,children:x.x}),(0,e.jsx)(yt.Z,{type:"vertical"}),(0,e.jsx)("span",{className:y().percent,children:"".concat((Number.isNaN(x.percent)?0:x.percent*100).toFixed(2),"%")}),(0,e.jsx)("span",{className:y().value,children:o?o(x.y):x.y})]},x.x)})})]})}}]),s}(C.Component),Lt=At()($t),zt=[{title:"col1",dataIndex:"col1",key:"col1"},{title:"col2",dataIndex:"col2",key:"col2"},{title:"col3",dataIndex:"col3",key:"col3"},{title:"col4",dataIndex:"col4",key:"col4"},{title:"col5",dataIndex:"col5",key:"col5"},{title:"col6",dataIndex:"col6",key:"col6"},{title:"col7",dataIndex:"col7",key:"col7"},{title:"col8",dataIndex:"col8",key:"col8"}],Bt=function(r){switch(r){case"10":return"100%";case"8":return"80%";case"6":return"60%";case"4":return"40%";case"2":return"20%";case"0":return"0%";default:return""}},Gt=function(){var r=(0,C.useState)([]),s=(0,N.Z)(r,2),t=s[0],i=s[1],d=(0,C.useState)([]),a=(0,N.Z)(d,2),o=a[0],l=a[1],h=(0,C.useState)([]),v=(0,N.Z)(h,2),f=v[0],m=v[1],Z=(0,C.useState)([]),S=(0,N.Z)(Z,2),j=S[0],F=S[1];return(0,C.useEffect)(function(){dt().then(function(u){if(u.code===200){var g=[];g.push({col1:"Redis\u7248\u672C",col2:u.data.info.redis_version,col3:"\u8FD0\u884C\u6A21\u5F0F",col4:u.data.info.redis_mode==="standalone"?"\u5355\u673A":"\u96C6\u7FA4",col5:"\u7AEF\u53E3",col6:u.data.info.tcp_port,col7:"\u5BA2\u6237\u7AEF\u6570",col8:u.data.info.connected_clients}),g.push({col1:"\u8FD0\u884C\u65F6\u95F4(\u5929)",col2:u.data.info.uptime_in_days,col3:"\u4F7F\u7528\u5185\u5B58",col4:u.data.info.used_memory_human,col5:"\u4F7F\u7528CPU",col6:"".concat(u.data.info.used_cpu_user_children,"%"),col7:"\u5185\u5B58\u914D\u7F6E",col8:u.data.info.maxmemory_human}),g.push({col1:"AOF\u662F\u5426\u5F00\u542F",col2:u.data.info.aof_enabled==="0"?"\u5426":"\u662F",col3:"RDB\u662F\u5426\u6210\u529F",col4:u.data.info.rdb_last_bgsave_status,col5:"Key\u6570\u91CF",col6:u.data.dbSize,col7:"\u7F51\u7EDC\u5165\u53E3/\u51FA\u53E3",col8:"".concat(u.data.info.instantaneous_input_kbps,"/").concat(u.data.info.instantaneous_output_kbps,"kps")}),i(g);var U=u.data.commandStats.map(function(D){return{x:D.name,y:Number(D.value)}});F(U),m(u.data.info.used_memory_human),l(u.data.info.used_memory/u.data.info.total_system_memory)}})},[]),(0,e.jsxs)(ht.Z,{children:[(0,e.jsx)(K.Z,{gutter:[24,24],children:(0,e.jsx)(B.Z,{span:24,children:(0,e.jsx)(G.Z,{title:"\u57FA\u672C\u4FE1\u606F",className:R().card,children:(0,e.jsx)(it.Z,{pagination:!1,showHeader:!1,dataSource:t,columns:zt})})})}),(0,e.jsxs)(K.Z,{gutter:[24,24],children:[(0,e.jsx)(B.Z,{span:12,children:(0,e.jsx)(G.Z,{title:"\u547D\u4EE4\u7EDF\u8BA1",className:R().card,children:(0,e.jsx)(Lt,{hasLegend:!0,data:j,height:320,lineWidth:4})})}),(0,e.jsx)(B.Z,{span:12,children:(0,e.jsx)(G.Z,{title:"\u5185\u5B58\u4FE1\u606F",className:R().card,children:(0,e.jsx)(xt,{title:f,height:320,percent:o,formatter:Bt})})})]})]})},Tt=Gt}}]);
